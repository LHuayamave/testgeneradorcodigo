public static DataSet.ActivosFijosPorResponsableDataTable DameActivosFijosPorResponsable(int secuencialEmpresa , int secuencialOficina, int secuencialPersonaResponsable, DateTime fechaUltimoCalculo)
{
SELECT
    activo.codigocompuesto,
    activo.descripcion,
    activo.fechasistema   fechacompra,
    activo.costo          costo,
    (
        SELECT
            calculo.depreciacionacumulada
        FROM
            fbs_activosfijos.calculo
        WHERE
            activo.secuencial = calculo.secuencialactivo
            AND calculo.fechacalculo = :fechaultimocalculo
    ) depreciacionacumulada,
    departamento.secuencial,
    departamento.nombre   departamento,
    (
        SELECT
            calculo.saldolibros
        FROM
            fbs_activosfijos.calculo
        WHERE
            activo.secuencial = calculo.secuencialactivo
            AND calculo.fechacalculo = :fechaultimocalculo
    ) saldolibros,
    persona.nombreunido   responsable,
    division.nombre       oficina
FROM
    fbs_activosfijos.activo,
    fbs_organizaciones.oficina,
    fbs_organizaciones.oficinadepartamento,
    fbs_organizaciones.departamento,
    fbs_activosfijos.persona_responsable,
    fbs_personas.persona,
    fbs_generales.division
WHERE
    oficina.secuencialdivision = oficinadepartamento.secuencialoficina
    AND oficinadepartamento.secuencial = activo.secuencialoficinadepartamento
    AND departamento.secuencial = oficinadepartamento.secuencialdepartamento
    AND persona_responsable.secuencialpersona = activo.secuencialpersonaresponsable
    AND oficina.secuencialempresa = :secuencialempresa
    AND persona_responsable.secuencialpersona = persona.secuencial
    AND oficina.secuencialdivision = division.secuencial
     if (secuencialOficina != 0)
     {
        AND OFICINA.SECUENCIALDIVISION = @secuencialOficina 
     }
     if (secuencialPersonaResponsable != 0)
     {
        AND ACTIVO.SECUENCIALPERSONARESPONSABLE = FbsSettings.Leeconfingurtacion().Secuencial
     }
}
